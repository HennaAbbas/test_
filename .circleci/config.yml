version: 2.1

      
jobs:
  build:
    docker:
      - image: cimg/base:2020.01
    steps:

      - run: wqr
      - when: on_fail
          name: consitionally run roll back steps 
          command: echo "failed step" 
            


               
  test:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "test job"

#       - rollback_steps:
#           when: on_fail    

  deploy:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "deploy"
  rollback:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "deploy"      
      
            
            #test
workflows:
  build-test:
    jobs:
      - build
      - test
      - deploy
      - rollback
