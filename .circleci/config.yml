version: 2.1
  
jobs:
  build:
    parameters:
      branch:
        type: string
        default: $CIRCLE_BRANCH 
    docker:
      - image: cimg/node:17.2.0
    
    steps:
      - setup_remote_docker: 
          version: previous
      - run: echo <<parameters.branch>>
      - run: xrm
      - run:
          command: |
            while true; do
              sleep 600
              echo "this in running  in the background"
            done
          background: true

  test:
    docker:
      - image: cimg/node:17.2.0


    steps:
      - run: xcodebuild -version      



workflows:
  say-hello-workflow:
    jobs:
      - test:
          filters:
            tags:
              only: /^pre-.*/   
      - build


