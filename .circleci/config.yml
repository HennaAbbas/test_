version: 2.1
orbs:
   aws-cli: circleci/aws-cli@1.0
   serverless: circleci/serverless-framework@1.0.1

jobs:
   one:
     docker:
       - image: cimg/elixir:1.11.0-browsers
     steps:
       - run: echo "hello world" 

   two:
    parameters:   
      use_remote_execution:
        type: boolean
        default: true        
    machine:
      image: ubuntu-2004-cuda-11.2:202103-01
    steps:
    - checkout   
    - when:
        condition: << parameters.use_remote_execution >>
        steps:
          - run: echo "use remote"         


workflows:
  one_and_two:
    jobs:
      - one
      - two
      - two: 
          name: other two          

  other_workflow:
    jobs:
      - one
      - two
#           workflow_name: e2e-tests-workflow
#           prefetch_docker_images: "hello-2"             
      - two: 
          name: other two 
#           <<: *ignore_intermediate_branches
#           prefetch_docker_images: "hello-2"             
#           workflow_name: something    
          use_remote_execution: false
#       - three      
