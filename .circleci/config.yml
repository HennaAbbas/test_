version: 2.1
orbs:
  hello-world: viar/hello-world@0.0.2
  browser-tools: circleci/browser-tools@1.4.4
parameters:
  test-suite:
    type: string
    default: ""

jobs:
  hello-job:
    docker:
      - image: cimg/node:17.2.0 # the primary container, where your job's commands are run
    steps:
      - checkout # check out the code in the project directory
  deploy_testflight:
    macos:
      xcode: 14.3.1
    resource_class: macos.x86.medium.gen2  
    steps:
      - browser-tools/install-chrome:
          # TODO remove following line when fixed https://github.com/CircleCI-Public/browser-tools-orb/issues/90
          chrome-version: 116.0.5845.96
      - browser-tools/install-chromedriver           
      

workflows:
  my-workflow:
    when: 
      equal: [ test, << pipeline.parameters.test-suite >> ]
    
  
    jobs:
      - hello-job
      - hello-world/greet: 
          to: "henna" 
  my-test-workflow:
    # when: 
    #   equal: [ test-1, << pipeline.parameters.test-suite >> ]
    
  
    jobs:
      - deploy_testflight
      - hello-job
      - hello-world/greet: 
          to: "henna"           


