version: '2.1'
orbs:
  gh: circleci/github-cli@2.0
  win: circleci/windows@5.0  
jobs:
  build:
    macos:
      xcode: 15.3.0
    resource_class: macos.m1.medium.gen1
    shell: /bin/bash --login -eo pipefail

    steps:

      - run: echo "hello world" 
      - run: mkdir -p workspace
      - run: echo "Hello, world!" > workspace/echo-output      
      - persist_to_workspace:
          # Must be an absolute path, or relative path from working_directory. This is a directory in the execution
          # environment which is taken to be the root directory of the workspace.
          root: workspace
          # Must be relative path from root
          paths:
            - echo-output
  test:
    macos:
      xcode: 15.3.0
    resource_class: macos.m1.medium.gen1
    shell: /bin/bash --login -eo pipefail

    steps:
      - run: echo "hello world" 
      - attach_workspace:
          at: ~/Library/Developer      

workflows:
  my_workflow:
    jobs:
      - build
      - test: 
          requires: 
            - build

