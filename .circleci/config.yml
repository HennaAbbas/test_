version: 2.1
parameters: 
      rollback_job: 
      type: boolean
      default: false


      
jobs:
  build:
    docker:
      - image: cimg/base:2020.01
    steps:

      - run: echo "build job"
   

               
  test:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "test job"

#       - rollback_steps:
#           when: on_fail    

  deploy:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "deploy"
  rollback:
    docker:
      - image: cimg/base:2020.01
    steps:
      - run: echo "rollback"      
      
            
            #test
workflows:
  build-test:
    jobs:
      - build
      - test
      - deploy
  rollback_workflow:
    when: << pipeline.parameters.rollback_job >>
    jobs:
      - rollback    
  


                  
                                  
            
