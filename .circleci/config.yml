version: 2.1
orbs:
  hello-world: viar/hello-world@0.0.2
  browser-tools: circleci/browser-tools@1.4.4
parameters:
  test-suite:
    type: string
    default: ""

jobs:
  hello-job:
    docker:
      - image: cimg/node:17.2.0 # the primary container, where your job's commands are run
    steps:
      - checkout # check out the code in the project directory
  deploy_testflight:
    macos:
      xcode: 14.3.1
    resource_class: macos.x86.medium.gen2  
    steps:
    - checkout
  ios_iPhone_13_V15_2:
    macos:  # use the macOS executor
      xcode: 13.4.1
    resource_class: macos.x86.medium.gen2
    environment:
      PLATFORM: iOS
      DEVICE_VERSION: 15.5
      DEVICE_NAME: iPhone_13_Test
      SIM_DEVICE_TYPE: com.apple.CoreSimulator.SimDeviceType.iPhone-13
      SIM_RUN_TIME: com.apple.CoreSimulator.SimRuntime.iOS-15-5
    steps:
      - browser-tools/install-chrome
      - browser-tools/install-chromedriver    
      

workflows:
  my-workflow:
    when: 
      equal: [ test, << pipeline.parameters.test-suite >> ]
    
  
    jobs:
      - hello-job
      - hello-world/greet: 
          to: "henna" 
  my-test-workflow:
    # when: 
    #   equal: [ test-1, << pipeline.parameters.test-suite >> ]
    
  
    jobs:
      - deploy_testflight
      - hello-job
      - hello-world/greet: 
          to: "henna"           


