orbs: # adds orbs to your configuration
  node: circleci/node@4.7.0
  codecov: codecov/codecov@3.2.0
  docker: circleci/docker@1.7.0
      
jobs:
  build:
    docker: 
      - image: cimg/node:14.0.0
      - image: rabbitmq
    steps:
      - checkout 
      - run: echo " my circle tok is ${CIRCLE_TOKEN}"
      - run: pwd
      - run: chmod +x ci.sh
      - run: ./ci.sh
#       - docker/install-dockerize:
#           version: v0.6.1
#       - node/install-packages:
#           override-ci-command: npm install
#       - run:
#           name: Wait for RabbitMQ to have started
#           command: dockerize -wait tcp://localhost:5672 -timeout 1m

#       - run:
#           name: Integration Tests
#           command: npm run test:integration          


version: 2.1
workflows:
  test_and_build:
    jobs:
      - build: 
          name: build number 1 
      - build: 
          name: build number 2
          requires: build number 1 
      #test
#test
