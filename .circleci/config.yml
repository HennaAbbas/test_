version: '2.1'
orbs:
  gh: circleci/github-cli@2.0
  win: circleci/windows@5.0  
jobs:
  create-a-deployment:
    docker:
      - image: cimg/node:18.7.0

    steps:
      - checkout
      - run: docker --version
      - run: node --version
      - setup_remote_docker:
          version: 20.10.14
          docker_layer_caching: true
      # - gh/install
      # - run:
      #     command: >
      #       gh api /repos/:owner/:repo/deployments --preview ant-man --input - \

      #       --jq '"export GH_DEPLOYMENT_STATUS_URL=\(.statuses_url)"' >>
      #       $BASH_ENV \<<JSON || true

      #       {

      #       "ref": "${CIRCLE_TAG:-$CIRCLE_SHA1}",

      #       "environment": "${AWS_ENVIRONMENT,,}",

      #       "auto_merge": false,

      #       "required_contexts": []

      #       }

      #       JSON
      #     name: Create Deployment
workflows:
  use-my-orb:
    when:
      or:
        - equals: [ main, << pipeline.git.branch >> ]  
    jobs:
      - create-a-deployment

